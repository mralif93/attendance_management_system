{% extends 'attendance/master/base.html' %}
{% load static %}

{% block title %}Attendance Management System{% endblock title %}
{% block css %}{% endblock css %}

{% block content %}
<div class="container mt-5">
  <h4 class="card-title">QR Scanner</h4>

  <div class="center">
    <div id="reader"></div>
  </div>
</div>
{% endblock content %}

{% block js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.8/html5-qrcode.min.js"></script>
<script>
    $(document).ready(function() {
      // console.log('ready!');

      // QR Scanner
      /** load scanner using back camera **/
      const scanner = new Html5QrcodeScanner('reader', {
        qrcode: {
          width: 250,
          height: 250,
        },
        fps: 20,
        facingMode: { 
          exact: "environment"
        }
      });
      scanner.render(success, error);

      function success(result) {
        alert(result);
        document.getElementById('result').innerHTML = `
        <h2>Success!</h2>
        <p class='fw-bold'>${result}</p>`;

        scanner.clear();
        document.getElementById('reader').remove();
      }

      function error(err) {
        alert(err);
      }
    });
</script>
{% endblock js %}